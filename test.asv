point2OnPlane = [-2,-2,0;
                         -2,3.5,0;
                         2,3.5,0;
                         2,-2,0];
        planeNormals = [0,-1,0;
                        -1,0,0;
                        0,-1,0;
                        0,-1,0];

for i = 1:4
    
LinePlaneIntersection(planeNormal,pointOnPlane,point1OnLine,point2OnLine)
 

function [intersectionPoint,check] = LinePlaneIntersection(planeNormal,pointOnPlane,point1OnLine,point2OnLine)
    
    intersectionPoint = [0 0 0];
    u = point2OnLine - point1OnLine;
    w = point1OnLine - pointOnPlane;
    D = dot(planeNormal,u);
    N = -dot(planeNormal,w);
    check = 0; %#ok<NASGU>
    if abs(D) < 10^-7        % The segment is parallel to plane
        if N == 0           % The segment lies in plane
            check = 2;
            return
        else
            check = 0;       %no intersection
            return
        end
    end
    
    %compute the intersection parameter
    sI = N / D;
    intersectionPoint = point1OnLine + sI.*u;
    
    if (sI < 0 || sI > 1)
        check= 3;          %The intersection point  lies outside the segment, so there is no intersection
    else
        check=1;
    end
end